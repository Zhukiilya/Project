from cryptography.hazmat.primitives.asymmetric import rsa, padding #0
from cryptography.hazmat.primitives import serialization, hashes
from getpass import getpass
from cryptography.hazmat.backends import default_backend
import ctypes


#getpass скрывает ввод пароля в консоли
password = getpass("Введите пароль для ключа: ").encode("utf-8")
private_rsa_key_a = rsa.generate_private_key(
    public_exponent=65537,
    key_size=4096,  # Длина модуля n = 4096 бит
    backend=default_backend()
)
private_key_pem = private_key.private_bytes(
    encoding=serialization.Encoding.PEM,
    format=serialization.PrivateFormat.PKCS8,
    encryption_algorithm=serialization.BestAvailableEncryption(password)
)

with open("private_key.pem", "wb") as f:
    f.write(private_key_pem)
S_a = private_rsa_key_a.sign(n_ae_bytes, padding=padding.PSS(mgf=padding.MGF1(hashes.SHA256()), salt_length=32), algorithm=hashes.SHA256())
